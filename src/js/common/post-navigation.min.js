var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,g,d){a!=Array.prototype&&a!=Object.prototype&&(a[g]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,g,d,l){if(g){d=$jscomp.global;a=a.split(".");for(l=0;l<a.length-1;l++){var m=a[l];m in d||(d[m]={});d=d[m]}a=a[a.length-1];l=d[a];g=g(l);g!=l&&null!=g&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:g})}};$jscomp.polyfill("Object.is",function(a){return a?a:function(a,d){return a===d?0!==a||1/a===1/d:a!==a&&d!==d}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,d){var g=this;g instanceof String&&(g=String(g));var m=g.length;d=d||0;for(0>d&&(d=Math.max(d+m,0));d<m;d++){var r=g[d];if(r===a||Object.is(r,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,g,d){if(null==a)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(g instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,d){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,d||0)}},"es6","es3");
$jscomp.arrayIteratorImpl=function(a){var g=0;return function(){return g<a.length?{done:!1,value:a[g++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,g){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})};
$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(d){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(d||"")+"_"+g++,d)}var g=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,g){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var d=0,l={next:function(){if(d<a.length){var m=d++;return{value:g(m,a[m]),done:!1}}l.next=function(){return{done:!0,value:void 0}};return l.next()}};l[Symbol.iterator]=function(){return l};return l};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
(function(){function a(a){updateUrl(a.post.url,"Creary - "+a.post.title,a);console.log(clone(a));k?(k.state=a,k.session=h,k.user=f?f.user:null):k=new Vue({el:"#post-navigation-view",data:{lang:lang,CONSTANTS:CONSTANTS,session:h,user:f?f.user:!1,state:a,comment:"",response_comment:"",active_comment:null,active_comment_edit:null,active_response:null,active_response_edit:null,comments_shown:CONSTANTS.POST.MAX_COMMENT_SHOWN,navigation:!0},watch:{state:{immediate:!0,deep:!0,handler:function(b,a){b&&(globalLoading.show=
!b.post)}}},mounted:function(){},methods:{nextPost:l,lastPost:m,showPost:showPost,humanFileSize:humanFileSize,getBuzzClass:function(b){var a={};a[b.buzz.level_name]=!0;return a},cbdToDollar:function(b){return"$ "+Asset.parseString(b).toPlainString()},assetToString:function(b){return Asset.parse(b).toFriendlyString()},assetPart:function(b,a){b=Asset.parse(b);switch(a){case "int":return b.toPlainString(null,!1).split(".")[0];case "dec":return b.toPlainString(null,!1).split(".")[1];case "sym":return b.asset.symbol;
default:return Asset.parse(b).toFriendlyString()}},getDefaultAvatar:R.getAvatar,getLicense:function(){return License.fromFlag(this.state.post.metadata.license)},dateFromNow:function(b){return toLocaleDate(b).fromNow()},formatDate:function(b){return moment(b+"Z").format("LLLL")},hasPaid:function(b){b=b||this.state.post;var a=moment();b=toLocaleDate(b.cashout_time);return a.isAfter(b)},getPayoutPostDate:function(b){b=b||this.state.post;var a=toLocaleDate(b.cashout_time);this.hasPaid(b)&&(a=toLocaleDate(b.last_payout));
return a.fromNow()},hasPromotion:function(){return 0<Asset.parseString(this.state.post.promoted).amount},getPromotion:function(){return"$ "+Asset.parseString(this.state.post.promoted).toPlainString()},getPayout:function(b,a,c){b=b||this.state.post;c||(c=2);var n=Asset.parseString(b.pending_payout_value);this.hasPaid(b)&&(n=Asset.parseString(b.total_payout_value),n=n.add(Asset.parseString(b.curator_payout_value)));return(a?"$ ":"")+n.toPlainString(c)},getFriendlyPayout:function(b){b=b||this.state.post;
return this.getPayout(b,!1)+" CBD"},getPendingPayouts:function(b,a){a&&console.log("Asset:",a);a=a?a.toLowerCase():"";b=b||this.state.post;var c=Asset.parse({amount:Asset.parseString(this.state.feed_price.base).toFloat()/Asset.parseString(this.state.feed_price.quote).toFloat(),nai:"cbd"}),n=this.state.props.cbd_print_rate,e=Asset.parseString(b.pending_payout_value);b=b.percent_crea_dollars/2E4;b=Asset.parse({amount:e.toFloat()*b,nai:"cbd"});e=Asset.parse({amount:NaNOr((e.toFloat()-b.toFloat())/c.toFloat(),
0),nai:"cgy"});n=Asset.parse({amount:NaNOr(b.toFloat()*(n/1E4),0),nai:"cbd"});c=Asset.parse({amount:NaNOr((b.toFloat()-n.toFloat())/c.toFloat(),0),nai:"crea"});switch(a){case "cgy":return e.toFriendlyString(null,!1);case "cbd":return n.toFriendlyString(null,!1);case "crea":return c.toFriendlyString(null,!1);default:return"("+n.toFriendlyString(null,!1)+", "+c.toFriendlyString(null,!1)+", "+e.toFriendlyString(null,!1)+")"}},showMoreComments:function(){this.comments_shown+=CONSTANTS.POST.COMMENT_SHOW_INTERVAL;
this.$forceUpdate()},getFeaturedImage:function(a){return(a=a.metadata.featuredImage)&&a.hash?{url:"https://ipfs3.creary.net/ipfs/"+a.hash}:a&&a.url?a:{}},getLinkedTags:function(a){var b=[];this.state.post.metadata.tags.forEach(function(a){b.push('<a href="/search?page=1&query='+encodeURIComponent(a)+'">'+a+"</a>")});return a?b.join(", "):b},isSameUser:function(){return this.session?this.state.post.author===this.session.account.username:!1},isCommentResponse:function(a,c){return a.parent_author===
c.author&&a.parent_permlink===c.permlink},editPost:function(){goTo("/publish?edit="+encodeURIComponent(this.state.post.author+"/"+this.state.post.permlink))},addComment:function(a,c,e){var b=this;makeComment(c?this.response_comment:this.comment,e,a,function(a,e){globalLoading.show=!1;catchError(a)||(c?b.cleanMakeResponse():b.cleanMakeComment(),p(b.state.post,b.state,b.state.discuss,b.state.category,null,!0))})},linkfy:function(a){return makeMentions(a,this.state)},mustShowCommentField:function(a){return null!=
this.active_response&&this.active_response.link===a.link||null!=this.active_response_edit&&this.active_response_edit.parent_author===a.author&&this.active_response_edit.parent_permlink===a.permlink},setActiveComment:function(a){this.active_comment=a;q&&(q.active_comment=a,q.$forceUpdate());this.$forceUpdate()},setActiveCommentEdit:function(a){this.active_comment_edit=a;this.comment=a.body;this.$forceUpdate()},cleanMakeComment:function(){this.active_comment_edit=this.active_comment=null;this.comment=
"";this.$forceUpdate()},cleanMakeResponse:function(){this.active_response_edit=this.active_response=null;this.response_comment="";this.$forceUpdate()},makeDownload:makeDownload,removeComment:function(a){var b=this;deleteComment(a,this.session,function(a,c){catchError(a)||(globalLoading.show=!1,p(b.state.post,b.state,b.state.discuss,b.state.category,null,!0))})},editComment:function(a){this.response_comment=a.body;this.active_response_edit=a},ignoreUser:function(a){function b(){return a.apply(this,
arguments)}b.toString=function(){return a.toString()};return b}(function(){ignoreUser(this.state.post.author,!0,function(a,c){d()})}),vote:function(a,c){console.log("Vote",a,c);c=c||this.state.post;if(this.session){var b=this,e=this.session.account.username;requireRoleKey(e,"posting",function(d){globalLoading.show=!0;crea.broadcast.vote(d,e,c.author,c.permlink,a,function(a,c){globalLoading.show=!1;catchError(a)||(p(b.state.post,b.state,b.state.discuss,b.state.category,null,!0),showModal("#modal-post"))})})}},
onVote:function(a){catchError(a)||p(this.state.post,this.state,this.state.discuss,this.state.category,null,!0)},onFollow:function(a,c){console.log("on follow-nav",a,c);catchError(a)||updateUserSession()}}});k.$forceUpdate();if(h){t?(t.session=h,t.user=f?f.user:null,t.state=a):t=new Vue({el:"#modal-promote",data:{lang:lang,session:h,user:f?f.user:null,state:a,amount:0},mounted:function(){},methods:{hideModalPromote:function(a){cancelEventPropagation(a);hideModal("#modal-promote");showModal("#modal-post")},
makePromotion:function(a){cancelEventPropagation(a);var b=this.session.account.username,c="@"+this.state.post.author+"/"+this.state.post.permlink,e=parseFloat(this.amount)+1E-4;console.log(e);e=Asset.parse({amount:e,nai:apiOptions.nai.CBD}).toFriendlyString(null,!1);console.log(e);var d=this;requireRoleKey(b,"active",function(a){globalLoading.show=!0;crea.broadcast.transfer(a,b,"null",e,c,function(a,b){globalLoading.show=!1;catchError(a)||(d.hideModalPromote(),updateUserSession())})})}}});if(a.post.download.resource)if(u)u.session=
h,u.user=f?f.user:null,u.state=a;else{var c=Asset.parse(a.post.download.price),e=c.asset.symbol===apiOptions.symbol.CREA?Asset.parseString("0.000 CREA"):Asset.parseString("0.000 CBD"),g=!1;h&&(e=c.asset.symbol===apiOptions.symbol.CREA?Asset.parseString(f.user.balance):Asset.parseString(f.user.cbd_balance),g=a.post.download.downloaders.includes(f.user.name));u=new Vue({el:"#modal-download",data:{lang:lang,session:h,user:f?f.user:!1,state:a,modal:{amount:c.toPlainString(null,!1),symbol:c.asset.symbol.toUpperCase(),
balance:e.toFriendlyString(null,!1),alreadyPayed:g,confirmed:!1}},mounted:function(){},methods:{cancelPay:function(){this.modal.confirmed=!1},confirmDownload:function(){console.log("Donwload content",this.modal.alreadyPayed,this.modal.confirmed);this.modal.alreadyPayed||this.modal.confirmed?makeDownload(null,h,this.user,this.state.post,function(){console.log("On download success");showModal("#modal-post")}):this.modal.confirmed=!0}}})}v?(v.session=h,v.user=f?f.user:null,v.state=a):v=new Vue({el:"#modal-report",
data:{lang:lang,session:h,user:f?f.user:null,state:a},methods:{vote:function(a,c){console.log("Vote",a,c);c=c||this.state.post;if(this.session){var b=this,e=this.session.account.username;requireRoleKey(e,"posting",function(d){globalLoading.show=!0;crea.broadcast.vote(d,e,c.author,c.permlink,a,function(a,c){globalLoading.show=!1;catchError(a);p(b.state.post,b.state,b.state.discuss,b.state.category,null,!0);showModal("#modal-post")})})}}}});q?(q.session=h,q.user=f?f.user:null,q.state=a):q=new Vue({el:"#modal-report-comment",
data:{lang:lang,session:h,user:f?f.user:null,state:a,active_comment:null},methods:{vote:function(a,c){console.log("Vote",a,c);c=c||this.state.post;if(this.session){var b=this,e=this.session.account.username;requireRoleKey(e,"posting",function(d){globalLoading.show=!0;crea.broadcast.vote(d,e,c.author,c.permlink,a,function(a,c){globalLoading.show=!1;catchError(a)||(p(b.state.post,b.state,b.state.discuss,b.state.category,null,!0),showModal("#modal-post"))})})}}}})}}function g(a,c,d){var e=function(a){console.log("Others",
a);w=new Vue({el:"#more-projects-navigation",data:{lang:lang,state:d,otherProjects:a,navigation:!0},updated:function(){mr.sliders.documentReady($);var a=$("#more-projects-navigation .flickity-slider");console.log("Slider modal updated",a.length);setTimeout(function(){a.each(function(a){a=$(this);0===a.children().length&&a.parent().remove()})},500)},methods:{loadPost:function(a,c){cancelEventPropagation(c);var b=k.state,e=[];this.otherProjects.forEach(function(a){e.push(a.link);b.content[a.link]=a});
c=b.discuss||"";b.discussion_idx[c]||(b.discussion_idx[c]={});b.discussion_idx[c].more_projects=e;p(a,k.state,c,"more_projects",e.indexOf(a.link))},getFeaturedImage:function(a){return(a=a.metadata.featuredImage)&&a.hash?{url:"https://ipfs3.creary.net/ipfs/"+a.hash}:a&&a.url?a:{}}}});w.$forceUpdate()},b=(new Date).toISOString().replace("Z","");crea.api.getDiscussionsByAuthorBeforeDateWith({start_permlink:"",limit:100,before_date:b,author:a},function(a,b){if(!catchError(a)){var d=[];console.log("Other projects",
b);b.discussions.forEach(function(a){a=parsePost(a,a.reblogged_by);a.permlink!==c&&a.metadata.featuredImage&&d.push(a)});if(d.length>CONSTANTS.POST.MAX_OTHER_PROJECTS){a=[];for(b=0;b<CONSTANTS.POST.MAX_OTHER_PROJECTS;b++){var g=randomNumber(0,d.length-1);a.push(d.splice(g,1)[0])}d=a}e(d)}})}function d(){k&&a(k.state)}function l(a){cancelEventPropagation(a);a=k.state;var c=a.discussions.indexOf(a.author.name+"/"+a.post.permlink);0<=c&&c<=a.discussions.length-2&&(c++,r(c,a),c>=a.discussions.length-
5&&creaEvents.emit("crea.scroll.bottom"))}function m(a){cancelEventPropagation(a);a=k.state;var c=a.discussions.indexOf(a.post.link);0<c&&c<=a.discussions.length-1&&(c--,r(c,a))}function r(a,c){console.log("postIndex",a);var e=clone(c.content[c.discussions[a]]);p(e,c,c.discuss,c.category,a)}function p(e,c,d,f,b,h){!h&&k&&(k.$set(k.state,"post",null),k.$forceUpdate());c=clone(c);console.log(d,f,c,e);var l=e.author+"/"+e.permlink;crea.api.getState("/"+e.metadata.tags[0]+"/@"+e.author+"/"+e.permlink,
function(k,h){k?console.error(k):(c.discuss=d||"",c.category=f,c.discussions=c.discussion_idx[d][f],c.postIndex=b?b:c.discussions.indexOf(e.author+"/"+e.permlink),console.log(c.postIndex,c.discussions.length),c.postIndex>=c.discussions.length-5&&creaEvents.emit("crea.scroll.bottom"),refreshAccessToken(function(b){var d=new HttpClient(apiOptions.apiUrl+String.format("/creary/%s/%s",e.author,e.permlink)),f=function(b){var d=Object.keys(h.accounts);0===d.length?console.log("No post:",h):(d.forEach(function(a){c.accounts[a]=
parseAccount(h.accounts[a])}),c.post=parsePost(h.content[l],b),c.author=parseAccount(h.accounts[c.post.author]),b=Object.keys(h.content),b.sort(function(a,b){a=toLocaleDate(h.content[a].created);return toLocaleDate(h.content[b].created).valueOf()-a.valueOf()}),b.forEach(function(a){c.post[a]=parsePost(h.content[a])}),c.post.comments=b,a(c),setTimeout(function(){g(e.author,e.permlink,c)},300))};d.when("done",function(a){a=jsonify(a).data;f(a.reblogged_by)});d.when("fail",function(a,b,c){console.error(b,
c);f()});d.headers={Authorization:"Bearer "+b};d.get({})}))})}var k,w,t,u,v,q,h,f;$(window).bind("popstate",function(d){d.originalEvent.state&&d.originalEvent.state.post&&a(d.originalEvent.state,!0)});creaEvents.on("navigation.state.update",function(a){console.log("updating navigation state");if(k){var c=k.state;a.post=c.post;a.postIndex=a.discussions.indexOf(c.post.link);a.author=c.author;a.discuss=c.discuss;a.category=c.category;k.state=a;k.$forceUpdate()}});creaEvents.on("navigation.post.data",
p);creaEvents.on("crea.session.login",function(a,c){h=a;f=c;d()});creaEvents.on("crea.session.update",function(a,c){h=a;f=c;d()});creaEvents.on("crea.session.logout",function(){f=h=!1;d()});creaEvents.on("crea.content.prepare",function(){currentPage={pathname:window.location.pathname,title:document.title}});creaEvents.on("crea.modal.ready",function(){console.log("MODALS Ready");setTimeout(function(){$("#modal-post").on("modalOpened.modals.mr",function(){console.log("Showing modal");$("body").css({overflow:"hidden"})}).on("modalClosed.modals.mr",
function(){console.log("Closing modal");$("body").css({overflow:""});updateUrl(currentPage.pathname,currentPage.title)})},1E3)})})();
