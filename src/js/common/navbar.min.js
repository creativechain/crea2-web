var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.checkStringArgs=function(a,c,b){if(null==a)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return a+""};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,b,e){if(c){b=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var h=a[e];h in b||(b[h]={});b=b[h]}a=a[a.length-1];e=b[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,b){var e=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var c=e.length,l=a.length;b=Math.max(0,Math.min(b|0,e.length));for(var k=0;k<l&&b<c;)if(e[b++]!=a[k++])return!1;return k>=l}},"es6","es3");
(function(){function a(d,a){f?(f.session=d,f.user=a?a.user:{}):f=new Vue({el:"#navbar-container",data:{lang:lang,session:d,user:a?a.user:{},nav:getPathPart(),loginForm:{xs:isSmallScreen(),username:{error:null,value:""},password:{error:null,value:""}}},mounted:function(){this.applyRightMenuEvents($);$("#modal-login").parent().removeAttr("modal-attached")},methods:{applyRightMenuEvents:function(a){},closeLogin:function(){hideModal("#modal-login");hideModal("#modal-login-d")},logout:logout,login:function(a){function d(d){return a.apply(this,
arguments)}d.toString=function(){return a.toString()};return d}(function(a){cancelEventPropagation(a);var d=this;this.loginForm.username.error||login(this.loginForm.username.value,this.loginForm.password.value,function(a){console.log(a);a?(console.error(a),d.loginForm.password.error=a===Errors.USER_LOGIN_ERROR?d.lang.ERROR[a].TITLE:d.lang.ERROR.UNKNOWN_ERROR,console.error(d.lang.ERROR[a])):d.closeLogin()})}),isUserFeed:isUserFeed,checkUsername:c,goTo:goTo,getDefaultAvatar:R.getAvatar,retrieveNowContent:e,
retrieveTrendingContent:h,retrieveHotContent:l,retrievePromotedContent:k}})}function c(a){a=a.target.value.toLowerCase();f.loginForm.username.value=a;crea.utils.validateAccountName(a)?f.loginForm.username.error=lang.ERROR.INVALID_USERNAME:(a=[a],console.log("Checking",a),crea.api.lookupAccountNames(a,function(a,d){a?(console.error(a),f.loginForm.username.error=lang.ERROR.INVALID_USERNAME):f.loginForm.username.error=null==d[0]?lang.ERROR.USERNAME_NOT_EXISTS:null}))}function b(a,b){isInHome()&&cancelEventPropagation(a);
var d=resolveFilter(b);updateUrl(b);currentPage.pathname=b;crea.api.getState(d,function(a,c){if(!catchError(a))if(isUserFeed()){var e=new HttpClient(apiOptions.apiUrl+"/creary/feed"),g=function(){c.content={};creaEvents.emit("crea.posts",b,d,c)};e.when("done",function(a){a=jsonify(a).data;if(a.length){var e=a.length;c.content={};a.forEach(function(a){var f=a.author+"/"+a.permlink;c.content[f]||crea.api.getContent(a.author,a.permlink,function(g,m){g?console.error("Error getting",f,g):(g=parsePost(m),
g.reblogged_by=a.reblogged_by,c.content[f]=g);e--;0>=e&&creaEvents.emit("crea.posts",b,d,c)})})}else g()});e.when("fail",function(a,d,b){catchError(d)});a=getPathPart().replace("/","").replace("@","");crea.api.getFollowing(a,"","blog",1E3,function(a,d){if(!catchError(a)){var b=[];d.following.forEach(function(a){b.push(a.following)});b.length?(b=b.join(","),refreshAccessToken(function(a){e.headers={Authorization:"Bearer "+a};e.post({following:b,reblogs:!0,adult:f.user.metadata.adult_content})})):g()}})}else creaEvents.emit("crea.posts",
b,d,c)})}function e(a){b(a,"/now")}function h(a){b(a,"/popular")}function l(a){b(a,"/skyrockets")}function k(a){b(a,"/promoted")}var f;new Vue({el:"#navbar-search",data:{lang:lang,search:null,page:1},methods:{reset:function(){this.search=null;this.page=1},performSearch:function(a){function b(b){return a.apply(this,arguments)}b.toString=function(){return a.toString()};return b}(function(a){cancelEventPropagation(a);this.search&&performSearch(this.search,this.page,isInHome())})}});new Vue({el:"#navbar-right-menu",
data:{lang:lang}});creaEvents.on("crea.posts",function(){f.nav=getPathPart()});creaEvents.on("crea.session.update",function(b,c){a(b,c)});creaEvents.on("crea.session.login",function(b,c){a(b,c)});creaEvents.on("crea.session.logout",function(){a(!1,!1);creaEvents.emit("crea.modal.ready",!0)});creaEvents.on("crea.content.filter",function(a){a.startsWith("/")||(a="/"+a);b(null,a)})})();
