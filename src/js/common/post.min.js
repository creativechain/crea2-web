var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,c){a!=Array.prototype&&a!=Object.prototype&&(a[d]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,d,c,k){if(d){c=$jscomp.global;a=a.split(".");for(k=0;k<a.length-1;k++){var g=a[k];g in c||(c[g]={});c=c[g]}a=a[a.length-1];k=c[a];d=d(k);d!=k&&null!=d&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var d=this;d instanceof String&&(d=String(d));var g=d.length;c=c||0;for(0>c&&(c=Math.max(c+g,0));c<g;c++){var l=d[c];if(l===a||Object.is(l,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,d,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(d instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");
$jscomp.arrayIteratorImpl=function(a){var d=0;return function(){return d<a.length?{done:!1,value:a[d++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,d){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:d})};
$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+d++,c)}var d=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,d){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,k={next:function(){if(c<a.length){var g=c++;return{value:d(g,a[g]),done:!1}}k.next=function(){return{done:!0,value:void 0}};return k.next()}};k[Symbol.iterator]=function(){return k};return k};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
(function(){function a(a){--u;(0===u||a)&&creaEvents.emit("crea.dom.ready")}function d(c){l?(l.state=c,l.session=h,l.user=e?e.user:null):(console.log(clone(c)),l=new Vue({el:"#post-view",data:{lang:lang,CONSTANTS:CONSTANTS,session:h,user:e?e.user:!1,state:c,comment:"",response_comment:"",active_comment:null,active_comment_edit:null,active_response:null,active_response_edit:null,comments_shown:CONSTANTS.POST.MAX_COMMENT_SHOWN,navigation:!1},mounted:function(){a()},methods:{showPost:showPost,humanFileSize:humanFileSize,
getBuzzClass:function(b){var a={};a[b.buzz.level_name]=!0;return a},cbdToDollar:function(b){return"$ "+Asset.parseString(b).toPlainString()},assetToString:function(b){return Asset.parse(b).toFriendlyString()},assetPart:function(b,a){b=Asset.parse(b);switch(a){case "int":return b.toPlainString(null,!1).split(".")[0];case "dec":return b.toPlainString(null,!1).split(".")[1];case "sym":return b.asset.symbol;default:return Asset.parse(b).toFriendlyString()}},getDefaultAvatar:R.getAvatar,getLicense:function(){return License.fromFlag(this.state.post.metadata.license)},
dateFromNow:function(b){return toLocaleDate(b).fromNow()},formatDate:function(b){return moment(b+"Z").format("LLLL")},hasPaid:function(b){b=b||this.state.post;var a=moment();b=toLocaleDate(b.cashout_time);return a.isAfter(b)},getPayoutPostDate:function(b){b=b||this.state.post;var a=toLocaleDate(b.cashout_time);this.hasPaid(b)&&(a=toLocaleDate(b.last_payout));return a.fromNow()},hasPromotion:function(){return 0<Asset.parseString(this.state.post.promoted).amount},getPromotion:function(){return"$ "+
Asset.parseString(this.state.post.promoted).toPlainString()},getPayout:function(b,a,c){b=b||this.state.post;c||(c=2);var f=Asset.parseString(b.pending_payout_value);this.hasPaid()&&(f=Asset.parseString(b.total_payout_value),f=f.add(Asset.parseString(b.curator_payout_value)));return(a?"$ ":"")+f.toPlainString(c)},getFriendlyPayout:function(b){b=b||this.state.post;return this.getPayout(b,!1)+" CBD"},getPendingPayouts:function(b,a){a=a?a.toLowerCase():"";b=b||this.state.post;var f=Asset.parse({amount:Asset.parseString(this.state.feed_price.base).toFloat()/
Asset.parseString(this.state.feed_price.quote).toFloat(),nai:"cbd"}),c=this.state.props.cbd_print_rate,d=Asset.parseString(b.pending_payout_value);b=b.percent_crea_dollars/2E4;b=Asset.parse({amount:d.toFloat()*b,nai:"cbd"});d=Asset.parse({amount:NaNOr((d.toFloat()-b.toFloat())/f.toFloat(),0),nai:"cgy"});c=Asset.parse({amount:NaNOr(b.toFloat()*(c/1E4),0),nai:"cbd"});f=Asset.parse({amount:NaNOr((b.toFloat()-c.toFloat())/f.toFloat(),0),nai:"crea"});switch(a){case "cgy":return d.toFriendlyString(null,
!1);case "cbd":return c.toFriendlyString(null,!1);case "crea":return f.toFriendlyString(null,!1);default:return"("+c.toFriendlyString(null,!1)+", "+f.toFriendlyString(null,!1)+", "+d.toFriendlyString(null,!1)+")"}},showMoreComments:function(){this.comments_shown+=CONSTANTS.POST.COMMENT_SHOW_INTERVAL;this.$forceUpdate()},getFeaturedImage:function(b){return(b=b.metadata.featuredImage)&&b.hash?{url:"https://ipfs.creary.net/ipfs/"+b.hash}:b&&b.url?b:{}},getLinkedTags:function(b){var a=[];this.state.post.metadata.tags.forEach(function(b){a.push('<a href="/popular/'+
encodeURIComponent(b)+'">'+b+"</a>")});return b?a.join(", "):a},isSameUser:function(){return this.session?this.state.post.author===this.session.account.username:!1},isCommentResponse:function(b,a){return b.parent_author===a.author&&b.parent_permlink===a.permlink},editPost:function(){goTo("/publish?edit="+encodeURIComponent(this.state.post.author+"/"+this.state.post.permlink))},addComment:function(b,a,c){var f=this;makeComment(a?this.response_comment:this.comment,c,b,function(b,c){globalLoading.show=
!1;catchError(b)||(a?f.cleanMakeResponse():f.cleanMakeComment(),g())})},linkfy:function(b){return makeMentions(b,this.state)},mustShowCommentField:function(b){return null!=this.active_response&&this.active_response.link===b.link||null!=this.active_response_edit&&this.active_response_edit.parent_author===b.author&&this.active_response_edit.parent_permlink===b.permlink},setActiveComment:function(b){this.active_comment=b;m&&(m.active_comment=b,m.$forceUpdate());this.$forceUpdate()},setActiveCommentEdit:function(b){this.active_comment_edit=
b;this.comment=b.body;this.$forceUpdate()},cleanMakeComment:function(){this.active_comment_edit=this.active_comment=null;this.comment="";this.$forceUpdate()},cleanMakeResponse:function(){this.active_response_edit=this.active_response=null;this.response_comment="";this.$forceUpdate()},makeDownload:makeDownload,removeComment:function(b){deleteComment(b,this.session,function(b,a){catchError(b)||(globalLoading.show=!1,g())})},editComment:function(b){this.response_comment=b.body;this.active_response_edit=
b},ignoreUser:function(b){function a(){return b.apply(this,arguments)}a.toString=function(){return b.toString()};return a}(function(){ignoreUser(this.state.post.author,!0,function(a,c){g()})}),vote:function(a,c){c=c||this.state.post;if(this.session){var b=this.session.account.username;requireRoleKey(b,"posting",function(f){globalLoading.show=!0;crea.broadcast.vote(f,b,c.author,c.permlink,a,function(a,b){globalLoading.show=!1;catchError(a);g()})})}},onVote:function(a){catchError(a);updateUserSession()},
onFollow:function(a,c){catchError(a);updateUserSession()}}}));if(h){n?(n.session=h,n.user=e?e.user:null,n.state=c):n=new Vue({el:"#modal-promote",data:{lang:lang,session:h,user:e?e.user:null,state:c,amount:0},mounted:function(){a()},methods:{hideModalPromote:function(a){cancelEventPropagation(a);hideModal("#modal-promote")},makePromotion:function(a){cancelEventPropagation(a);var b=this.session.account.username,c="@"+this.state.post.author+"/"+this.state.post.permlink,d=parseFloat(this.amount)+1E-4;
console.log(d);d=Asset.parse({amount:d,nai:apiOptions.nai.CBD}).toFriendlyString(null,!1);console.log(d);var e=this;requireRoleKey(b,"active",function(a){globalLoading.show=!0;crea.broadcast.transfer(a,b,"null",d,c,function(a,b){globalLoading.show=!1;catchError(a)||(e.hideModalPromote(),updateUserSession())})})}}});if(c.post.download.resource)if(p)p.session=h,p.user=e?e.user:null,p.state=c;else{var d=Asset.parse(c.post.download.price),k=d.asset.symbol===apiOptions.symbol.CREA?Asset.parseString("0.000 CREA"):
Asset.parseString("0.000 CBD"),t=!1;h&&(k=d.asset.symbol===apiOptions.symbol.CREA?Asset.parseString(e.user.balance):Asset.parseString(e.user.cbd_balance),t=c.post.download.downloaders.includes(e.user.name));p=new Vue({el:"#modal-download",data:{lang:lang,session:h,user:e?e.user:!1,state:c,modal:{amount:d.toPlainString(null,!1),symbol:d.asset.symbol.toUpperCase(),balance:k.toFriendlyString(null,!1),alreadyPayed:t,confirmed:!1}},mounted:function(){a()},methods:{cancelPay:function(){this.modal.confirmed=
!1},confirmDownload:function(){this.modal.alreadyPayed||this.modal.confirmed?makeDownload(null,h,this.user,this.state.post,g):this.modal.confirmed=!0}}})}else a();q?(q.session=h,q.user=e?e.user:null,q.state=c):q=new Vue({el:"#modal-report",data:{lang:lang,session:h,user:e?e.user:null,state:c},mounted:function(){a()},methods:{vote:function(a,c){console.log("Vote",a,c);c=c||this.state.post;if(this.session){var b=this.session.account.username;requireRoleKey(b,"posting",function(f){globalLoading.show=
!0;crea.broadcast.vote(f,b,c.author,c.permlink,a,function(a,b){globalLoading.show=!1;catchError(a);g()})})}}}});m?(m.session=h,m.user=e?e.user:null,m.state=c):m=new Vue({el:"#modal-report-comment",data:{lang:lang,session:h,user:e?e.user:null,state:c,active_comment:null},mounted:function(){a()},methods:{vote:function(a,c){console.log("Report comment",a,c);c=c||this.state.post;if(this.session){var b=this.session.account.username;requireRoleKey(b,"posting",function(f){globalLoading.show=!0;crea.broadcast.vote(f,
b,c.author,c.permlink,a,function(a,b){globalLoading.show=!1;catchError(a);g()})})}}}})}else a(!0)}function c(a){a||(a=r);a=a.replace("@","").split("/");a.splice(0,2);return a.join("/")}function k(a,c,d){var e=function(a){v=new Vue({el:"#more-projects",data:{lang:lang,state:d,otherProjects:a,navigation:!1},updated:function(){mr.sliders.documentReady($);var a=$("#more-projects .flickity-slider");console.log("Slider post updated",a.length);setTimeout(function(){a.each(function(a){a=$(this);0===a.children().length&&
a.parent().remove()})},500)},methods:{loadPost:function(a,b){cancelEventPropagation(b);console.log("loading");var c=l.state,d=[];this.otherProjects.forEach(function(a){d.push(a.link);c.content[a.link]=a});b=c.discuss||"";c.discussion_idx[b]||(c.discussion_idx[b]={});c.discussion_idx[b].more_projects=d;creaEvents.emit("navigation.post.data",a,l.state,b,"more_projects",d.indexOf(a.link));showModal("#modal-post")},getFeaturedImage:function(a){return(a=a.metadata.featuredImage)&&a.hash?{url:"https://ipfs.creary.net/ipfs/"+
a.hash}:a&&a.url?a:{}}}});v.$forceUpdate()},b=(new Date).toISOString().replace("Z","");crea.api.getDiscussionsByAuthorBeforeDateWith({start_permlink:"",limit:100,before_date:b,author:a},function(a,b){if(!catchError(a)){var d=[];b.discussions.forEach(function(a){a.metadata=jsonify(a.json_metadata);a.permlink!==c&&a.metadata.featuredImage&&d.push(a)});if(12<d.length){a=[];for(b=0;12>b;b++){var f=randomNumber(0,d.length-1);a.push(d.splice(f,1)[0])}d=a}e(d)}})}function g(){if(r){var a=function(a){crea.api.getState(a,
function(b,f){catchError(b)||refreshAccessToken(function(b){var e=a.slice(1,a.length).split("/"),g=e[1].slice(1,e[1].length);e=new HttpClient(apiOptions.apiUrl+String.format("/creary/%s/%s",g,e[2]));var h=function(b){var e=Object.keys(f.accounts);0===e.length?goTo("/404"):(e.forEach(function(a){f.accounts[a]=parseAccount(f.accounts[a])}),f.postKey=c(a),f.post=parsePost(f.content[f.postKey],b),f.author=parseAccount(f.accounts[f.post.author]),b=Object.keys(f.content),b.sort(function(a,b){a=toLocaleDate(f.content[a].created);
return toLocaleDate(f.content[b].created).valueOf()-a.valueOf()}),b.forEach(function(a){f.post[a]=parsePost(f.content[a])}),f.post.comments=b,d(f),k(f.post.author,f.post.permlink,f))};e.when("done",function(a){a=jsonify(a).data;h(a.reblogged_by)});e.when("fail",function(a,b,c){console.error(b,c);h()});e.headers={Authorization:"Bearer "+b};e.get({})})})};if(2===r.slice(1,r.length).split("/").length){var e=getPathPart().replace("@",""),g=getPathPart(null,1);crea.api.getContent(e,g,function(c,b){catchError(c)||
(c=parsePost(b),a("/"+c.metadata.tags[0]+"/@"+e+"/"+g))})}else a(r)}}var l,v,n,p,q,m,r=window.location.pathname,h,e,u=5;creaEvents.on("crea.session.login",function(a,c){h=a;e=c;g()});creaEvents.on("crea.session.update",function(a,c){h=a;e=c;g()});creaEvents.on("crea.session.logout",function(){e=h=!1;g()})})();
