(function(){function d(a,b){c?(c.session=a,c.user=b?b.user:{}):c=new Vue({el:"#navbar-mobile",data:{lang:lang,session:a,user:b?b.user:{},nav:getPathPart()},methods:{isUserFeed:isUserFeed,goTo:goTo,getDefaultAvatar:R.getAvatar,retrieveNowContent:g,retrieveTrendingContent:h,retrieveHotContent:k,retrievePromotedContent:l}})}function e(a,b){isInHome()&&cancelEventPropagation(a);var c=resolveFilter(b);updateUrl(b);currentPage.pathname=b;crea.api.getState(c,function(a,f){if(!catchError(a))if(isUserFeed()){var d=
new HttpClient(apiOptions.apiUrl+"/creary/feed"),e=function(){f.content={};creaEvents.emit("crea.posts",b,c,f)};d.when("done",function(a){a=jsonify(a).data;if(a.length){var d=a.length;f.content={};a.forEach(function(a){var e=a.author+"/"+a.permlink;f.content[e]||crea.api.getContent(a.author,a.permlink,function(a,m){a?console.error("Error getting",e,a):f.content[e]=m;d--;0>=d&&creaEvents.emit("crea.posts",b,c,f)})})}else e()});d.when("fail",function(a,b,d){catchError(b)});a=getPathPart().replace("/",
"").replace("@","");crea.api.getFollowing(a,"","blog",1E3,function(a,b){if(!catchError(a)){var c=[];b.following.forEach(function(a){c.push(a.following)});c.length?(c=c.join(","),refreshAccessToken(function(a){d.headers={Authorization:"Bearer "+a};d.post({following:c,reblogs:!0,adult:account.user.metadata.adult_content})})):e()}})}else creaEvents.emit("crea.posts",b,c,f)})}function g(a){e(a,"/now")}function h(a){e(a,"/popular")}function k(a){e(a,"/skyrockets")}function l(a){e(a,"/promoted")}var c;
creaEvents.on("crea.posts",function(){c.nav=getPathPart()});creaEvents.on("crea.content.prepare",function(){d(!1,null)});creaEvents.on("crea.session.update",function(a,b){d(a,b)});creaEvents.on("crea.session.login",function(a,b){d(a,b)});creaEvents.on("crea.session.logout",function(){d(!1,!1)})})();
