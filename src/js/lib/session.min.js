var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");var Session=function(a,b){this.account=a;this.keepAlive=void 0===b?!0:b};
Session.prototype.login=function(a){var b=this;crea.api.getState("@"+this.account.username,function(c,d){if(c)a(c);else if(d.accounts[b.account.username]){d.user=parseAccount(d.accounts[b.account.username]);crea.formatter.estimateAccountValue(d.user).then(function(a){d.user.estimate_account_value=a});var e=!0;Object.keys(b.account.keys).some(function(a){var c=a;if("unknown"===c)console.log(DEFAULT_ROLES),DEFAULT_ROLES.some(function(a){f="memo"===a?d.user[a+"_key"]:d.user[a].key_auths[0][0];if(b.account.keys[c].pub===
f)return b.account.keys[a]=clone(b.account.keys[c]),delete b.account.keys[c],c=a,!0});else var f="memo"===c?d.user[c+"_key"]:d.user[c].key_auths[0][0];return e=b.account.keys[c].pub===f});e?(localStorage.setItem(CREARY.LANG,d.user.metadata.lang),a(null,d)):a(Errors.USER_LOGIN_ERROR,d)}else null===localStorage.getItem(CREARY.LANG)&&localStorage.setItem(CREARY.LANG,getNavigatorLanguage()),a(Errors.USER_NOT_FOUND)})};
Session.prototype.save=function(){var a=jsonstring(this);this.keepAlive?(localStorage.setItem(CREARY.SESSION,a),sessionStorage.setItem(CREARY.SESSION,!1)):(sessionStorage.setItem(CREARY.SESSION,a),localStorage.setItem(CREARY.SESSION,!1))};Session.prototype.logout=function(){localStorage.setItem(CREARY.SESSION,!1);sessionStorage.setItem(CREARY.SESSION,!1)};Session.create=function(a,b,c){a=Account.generate(a,b,c);return new Session(a)};
Session.getAlive=function(){var a=jsonify(localStorage.getItem(CREARY.SESSION));if(a.account)return new Session(a.account,a.keepAlive);a=jsonify(sessionStorage.getItem(CREARY.SESSION));return a.account?new Session(a.account,a.keepAlive):!1};
