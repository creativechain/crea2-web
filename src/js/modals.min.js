"use strict";(function(){var b;var a;function e(){var f={title:"",body:[]};if(!a){a=new Vue({el:"#modal-alert",data:{lang:lang,config:clone(f),show:false},mounted:function i(){var j=this;$("#modal-alert").on("modalClosed.modals.mr",function(){j.closeModal()})},methods:{cleanModal:function g(){this.config=clone(f)},closeModal:function h(j){cancelEventPropagation(j);this.cleanModal();this.show=false}}})}}function d(){var f={username:{disabled:false,value:"",error:null},password:{value:"",error:null}};if(!b){b=new Vue({el:"#modal-role",data:{lang:lang,id:null,title:"",role:null,login:false,inputs:clone(f),show:false},mounted:function k(){var l=this;$("#modal-role").on("modalClosed.modals.mr",function(){l.closeModal()})},methods:{cleanModal:function g(){this.inputs=clone(f);this.title="";this.role="";this.id=null},closeModal:function h(l){cancelEventPropagation(l);this.cleanModal();this.show=false},checkUsername:function j(n){var o=n.target.value.split("/")[0];var m=this;if(!crea.utils.validateAccountName(o)){var l=[o];crea.api.lookupAccountNames(l,function(q,p){if(q){console.error(q);m.inputs.username.error=m.lang.ERROR.INVALID_USERNAME}else{if(p[0]==null){m.inputs.username.error=m.lang.ERROR.USERNAME_NOT_EXISTS}else{m.inputs.username.error=null}}})}else{m.inputs.username.error=m.lang.ERROR.INVALID_USERNAME}},fetchKey:function i(o){cancelEventPropagation(o);if(!this.inputs.username.error&&this.inputs.password.value){var n=this;var q=this.inputs.username.value.split("/")[0];var p=this.role;var l=this.inputs.password.value;var m=Session.create(q,l,p);m.login(function(s,r){if(!catchError(s)){if(n.login){m.save()}creaEvents.emit("crea.auth.role."+n.id,m.account.keys[p].prv,q);n.closeModal()}})}}}})}}function c(){e();d()}creaEvents.on("crea.alert",function(f){console.log(f);a.config=f;a.show=true});creaEvents.on("crea.auth.role",function(i,h,f,g){b.id=g;b.inputs.username.value=i;b.role=h;b.login=f;b.show=true});creaEvents.on("crea.content.loaded",function(){c()})})();