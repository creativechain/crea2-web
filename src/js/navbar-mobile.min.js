(function(){var c;function f(i,h){if(!c){c=new Vue({el:"#navbar-mobile",data:{lang:lang,session:i,user:h?h.user:{},nav:getPathPart()},methods:{isUserFeed:isUserFeed,goTo:goTo,getDefaultAvatar:R.getAvatar,retrieveNowContent:a,retrieveTrendingContent:e,retrieveHotContent:b,retrievePromotedContent:d}})}else{c.session=i;c.user=h?h.user:{}}}function g(i,j){if(isInHome()){cancelEventPropagation(i)}var h=resolveFilter(j);updateUrl(j);crea.api.getState(h,function(m,n){if(!catchError(m)){if(isUserFeed()){var l=new HttpClient(apiOptions.apiUrl+"/creary/feed");var k=function k(){n.content={};creaEvents.emit("crea.posts",j,h,n)};l.when("done",function(p){var r=jsonify(p).data;if(r.length){var q=r.length;var s=function s(){q--;if(q<=0){creaEvents.emit("crea.posts",j,h,n)}};n.content={};r.forEach(function(u){var t=u.author+"/"+u.permlink;if(!n.content[t]){crea.api.getContent(u.author,u.permlink,function(w,v){if(w){console.error("Error getting",t,w)}else{n.content[t]=v}s()})}})}else{k()}});l.when("fail",function(p,r,q){catchError(r)});var o=getPathPart().replace("/","").replace("@","");crea.api.getFollowing(o,"","blog",1000,function(r,p){if(!catchError(r)){var q=[];p.following.forEach(function(s){q.push(s.following)});if(q.length){q=q.join(",");refreshAccessToken(function(s){l.headers={Authorization:"Bearer "+s};l.post({following:q})})}else{k()}}})}else{creaEvents.emit("crea.posts",j,h,n)}}})}function a(h){g(h,"/now")}function e(h){g(h,"/popular")}function b(h){g(h,"/skyrockets")}function d(h){g(h,"/promoted")}creaEvents.on("crea.posts",function(){c.nav=getPathPart()});creaEvents.on("crea.content.prepare",function(){f(false,null)});creaEvents.on("crea.session.update",function(i,h){f(i,h)});creaEvents.on("crea.session.login",function(i,h){f(i,h)});creaEvents.on("crea.session.logout",function(){f(false,false)})})();